# Dynamic NFC/RFID tag (STMicro's ST25DV04K) with RN4020

## Application abstract

RN4020 as a BLE module receives URI write requests from a BLE central (RasPi), and transfer the requests to STM32. STM32 writes the URI to NFC tag via I2C everytime it receives a request.

## URI write request


```
     +-----------------------+
     |  NDEF URL identifier  |
     +-----------------------+
     |  ','                  |
     +-----------------------+
     |  URI field[0]         |
     +-----------------------+
     |  URI field[1]         |
     +-----------------------+
     |       :               |
     |       :               |
     +-----------------------+
     |  URI field[n]         |
     +-----------------------+
     |  '\n'                 |
     +-----------------------+

```

Example: 3,amazon.co.jp\n

Due to the limitation of BLE payload size (max. 20bytes), the request message is split into multiple data.


## Collision problem

I was going to use USART1 for RN4020, but USART1's RX (PA10) is already used by X-CUBE-NFC4/X-NUCLEO-NFC05A1 for YELLOW LED.

So I use USART6 instead.

## A bug in X-CUBE-NFC4/CubeMX

BSP folder is removed whenever code is generated by CubeMX after the initial generation. Copy BSP into the folder manually to cope with the problem.
